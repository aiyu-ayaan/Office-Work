<div class="below-innovation-banner">
    <h2 class="text-below-innovation-heading has-text-align-center large-size">
        What We Do
    </h2>
    <p class="has-text-align-center medium-size text-below-innovation-banner animated-text-transition"
        id="animatedParagraph">
        We rethink the obvious to <span class="color-ia">unlock the extraordinary</span>â€”turning ideas into <span
            class="color-ia">real world impact</span>. <br />At ADROSONIC, <span class="color-ia">innovation </span>
        isn't just
        talk; it's something we <span class="color-ia">deliver</span>, time and again.
    </p>
    <a href="/contact-us/"><button class="custom-button">
            Discover Bold Solutions
        </button></a>
</div>


<style>
    .below-innovation-banner {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1;
        text-align: center;
        position: relative;
        margin-bottom: 2.05%;
    }

    .text-below-innovation-banner {
        width: 45.84%;
        margin-bottom: 2.52% !important;
    }

    .text-below-innovation-heading {
        color: #fff;
        font-style: normal;
        font-weight: 500 !important;
        margin-bottom: 2.52% !important;
    }

    @media (max-height: 650px) {
        .below-innovation-banner {
            margin-bottom: 6.16%;
        }
    }

    /* Landscape Tablet */
    @media screen and (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
        .below-innovation-banner {
            margin-bottom: 3.96%;
        }

        .text-below-innovation-banner {
            width: 69.69%;
            margin-bottom: 3.96% !important;
        }

        /* .button-innovation {
margin-top: 3.96%;
} */
        .text-below-innovation-heading {
            margin-bottom: 5.76% !important;
        }
    }

    /* Portrait Tablet */
    @media screen and (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
        .below-innovation-banner {
            margin-bottom: 3.96%;
        }

        .text-below-innovation-banner {
            width: 71.23%;
            margin-bottom: 1.125em !important;
        }

        /* .button-innovation {
margin-top: 1.125em;
} */
        .text-below-innovation-heading {
            margin-bottom: 4.8% !important;
        }
    }

    /* Mobile */
    @media screen and (max-width: 767.5px) {
        .below-innovation-banner {
            padding: 6.2%;
            margin-bottom: 0;
        }

        .text-below-innovation-banner {
            width: 100%;
            margin-bottom: 9.6% !important;
        }

        .text-below-innovation-heading {
            margin-bottom: 7% !important;
        }
    }

    /* Mobile landscape with height constraints */
    @media (max-width: 767.5px) and (max-height: 650px) and (orientation: landscape) {
        .below-innovation-banner {
            margin-bottom: 6.16% !important;
        }

        .text-below-innovation-heading {
            margin-bottom: 7.03% !important;
        }
    }

    /* Color transition animation styles */
    .animated-text-transition {
    animation: containerFadeIn 0.6s ease-out 0.4s forwards; /* Changed from 0.3s to 0.6s, delay from 0.2s to 0.4s */
    color: #FFFFFF5C;
}

.animated-text-transition .word {
    display: inline-block;
    color: #FFFFFF5C;
    animation: wordColorTransition 1.5s ease-out calc(var(--n) * 0.3s) forwards; /* Changed from 0.9s to 1.5s, stagger from 0.2s to 0.3s */
}

.animated-text-transition .color-ia .word {
    animation-name: colorIaTransition;
    animation-duration: 1.5s; /* Ensure highlighted words also use slower duration */
    animation-delay: calc(var(--n) * 0.3s);
    animation-timing-function: ease-out;
    animation-fill-mode: forwards;
}

    .animated-text-transition .word:last-child {
        margin-right: 0;
    }

    @keyframes containerFadeIn {
        to {
            opacity: 1;
        }
    }

    @keyframes wordColorTransition {
        to {
            color: white;
        }
    }

    @keyframes colorIaTransition {
        to {
            color: var(--adro-electric-blue);
        }
    }
</style>
<script>
    // Utility: build animated spans from original HTML
    function buildAnimatedTextFromHTML(html, targetEl) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(`<div>${html}</div>`, 'text/html');
        const container = doc.querySelector('div');

        let wordIndex = 0;

        function processNode(node) {
            if (node.nodeType === Node.TEXT_NODE) {
                const text = node.textContent;
                const parts = text.split(/(\s+)/);

                const fragment = document.createDocumentFragment();

                parts.forEach(part => {
                    if (part.trim()) {
                        const subParts = part.split(/([^\w\s'-])/);
                        subParts.forEach(subPart => {
                            if (subPart) {
                                const span = document.createElement('span');
                                span.className = 'word';
                                span.style.setProperty('--n', wordIndex);
                                span.textContent = subPart;
                                fragment.appendChild(span);
                                wordIndex++;
                            }
                        });
                    } else {
                        fragment.appendChild(document.createTextNode(part));
                    }
                });

                node.parentNode.replaceChild(fragment, node);
            } else if (node.nodeType === Node.ELEMENT_NODE) {
                Array.from(node.childNodes).forEach(child => processNode(child));
            }
        }

        Array.from(container.childNodes).forEach(child => processNode(child));
        targetEl.innerHTML = container.innerHTML;
    }

    document.addEventListener('DOMContentLoaded', function () {
        const paragraph = document.getElementById('animatedParagraph');
        if (!paragraph) return;

        // Save the pristine HTML so we can rebuild animations fresh each time
        const originalHTML = paragraph.innerHTML.trim();

        // First build on load so initial view animates
        buildAnimatedTextFromHTML(originalHTML, paragraph);

        // Replay control to avoid excessive retriggers
        let lastReplayAt = 0;
        const REPLAY_COOLDOWN_MS = 600; // slightly less than total stagger ensures smoothness

        // Observer to trigger when paragraph is at least 30% visible
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting && entry.intersectionRatio >= 0.3) {
                        const now = Date.now();
                        if (now - lastReplayAt < REPLAY_COOLDOWN_MS) return;

                        // Reset HTML to original (removes previous spans and animations)
                        paragraph.classList.remove('animated-text-transition');
                        paragraph.innerHTML = originalHTML;

                        // Force reflow so CSS animations can restart reliably
                        void paragraph.offsetWidth;

                        // Re-apply animated structure and class
                        buildAnimatedTextFromHTML(originalHTML, paragraph);
                        paragraph.classList.add('animated-text-transition');

                        lastReplayAt = now;
                    }
                });
            },
            {
                root: null,
                threshold: [0, 0.3, 0.6, 1],
            }
        );

        // Ensure the class is present for the container animation
        paragraph.classList.add('animated-text-transition');
        observer.observe(paragraph);
    });
</script>