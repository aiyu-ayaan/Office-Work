<!-- How Adrosonic Benefits Section  -->
<div class="adro-benefits" id="benefits">
    <div class="section-header-container">
        <h2 class="large-size  font-bold">
            <?php echo $adrosonic_benefits_section_main_header ?>
        </h2>
    </div>
    <div class="container">
        <div class="left-box">
            <div class="content"></div>
        </div>
        <div class="right-box">
            <ul class="benefits-menu">
                <?php if (have_rows('acf_our_capabilities_section_fields_items')) :
					$index=-1;?>
                <?php while(have_rows('acf_our_capabilities_section_fields_items')): the_row();
					$index++;
                                    $benefits_menu_item = get_sub_field('acf_industry_right_menu_items')?:''; ?>
                <li data-category="benefit-<?php echo esc_html($index+1); ?>" class="li-item active small-size">
                    <?php echo esc_html($benefits_menu_item); ?>
                </li>
                <?php endwhile; ?>
                <?php else : ?>
                <p>No benefits found.</p>
                <?php endif; ?>
            </ul>
        </div>
    </div>
</div>


<script>
    document.addEventListener("DOMContentLoaded", function () {
            const benefitsData = {};

            wpDataService.left_images.forEach((image, index) => {
                benefitsData[`benefit-${index + 1}`] = {
                    overlayText: wpDataService.left_image_overlay_texts[index] || "",
                    imageSrc: image,
                };
            });
            function updateBenefitsLeftBox(category) {
                const data = benefitsData[category];
                const leftBoxContent = document.querySelector(
                    ".adro-benefits .left-box .content"
                );
                leftBoxContent.innerHTML = `
<img class="leftBoxImage manual-lazy-load" data-src="${data.imageSrc}" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 7 5'%3E%3C/svg%3E" alt="Image" />
<div class="medium-size leftBoxDescription">${data.overlayText}</div>
            `;
            }
            function initLeftBoxCarousel() {
                const isPortrait = window.matchMedia(
                    "(max-width: 1024px) and (orientation: portrait)"
                ).matches;
                const isBelow767 = window.matchMedia("(max-width: 767.5px)").matches;
                let carouselContainer = jQuery(".adro-benefits .content");

                if (isPortrait || isBelow767) {
                    let carouselItems = "";
                    Object.keys(benefitsData).forEach((category) => {
                        const data = benefitsData[category];
                        carouselItems += `
<div class="carousel-item">
<img data-src="${data.imageSrc
                            }" class="manual-lazy-load leftBoxImage" alt="Image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 7 5'%3E%3C/svg%3E" />
<div class="medium-size leftBoxDescription">${data.overlayText
                            }</div>
<div class="benefit small-size">${getbyAttribute(
                                category
                            )}</div> 
</div>
                    `;
                    });

                    carouselContainer.addClass("owl-carousel").owlCarousel("destroy");
                    carouselContainer.html(carouselItems);
                    carouselContainer.owlCarousel({
                        items: 1,
                        loop: true,
                        margin: 16,
                        nav: true,
                        dots: true,
                        mouseDrag: false,
                        touchDrag: true,
                        autoplay: true,
                        autoplayHoverpause: true,
                        autoplayTimeout: 5000,
                        smartSpeed: 800,
                        responsive: {
                            768: {
                                items: 1,
                            },
                        },
                    });
                } else {
                    carouselContainer
                        .removeClass("owl-carousel owl-loaded")
                        .trigger("destroy.owl.carousel");
                    const firstItem = document.querySelector(
                        ".adro-benefits .benefits-menu .li-item"
                    );
                    activateRightBoxMenuItem(firstItem);
                    updateBenefitsLeftBox(firstItem.getAttribute("data-category"));
                }
            }

            function activateRightBoxMenuItem(element) {
                document
                    .querySelectorAll(".adro-benefits .benefits-menu .li-item")
                    .forEach((item) => {
                        item.classList.remove("active");
                        item.classList.remove("medium-size");
                        item.classList.add("small-size");
                    });
                element.classList.add("active");
                element.classList.add("medium-size");
                element.classList.remove("small-size");
            }

            function getbyAttribute(category) {
                const element = document.querySelector(`li[data-category="${category}"]`);
                return element ? element.innerHTML : "";
            }
            function adjustMenuOverflow() {
                const benefitsMenu = document.querySelector(
                    ".adro-benefits .benefits-menu"
                );
                const listItems = benefitsMenu.querySelectorAll("li").length;

                if (listItems > 4) {
                    benefitsMenu.style.overflowY = "auto";
                } else {
                    benefitsMenu.style.overflowY = "hidden";
                }
            }
            document
                .querySelectorAll(".adro-benefits .benefits-menu .li-item")
                .forEach((item) => {
                    item.addEventListener("mouseenter", function () {
                        const category = this.getAttribute("data-category");
                        activateRightBoxMenuItem(this);
                        updateBenefitsLeftBox(category);
                    });
                });
            const firstItem = document.querySelector(
                ".adro-benefits .benefits-menu .li-item"
            );
            activateRightBoxMenuItem(firstItem);
            updateBenefitsLeftBox(firstItem.getAttribute("data-category"));
            jQuery(window).resize(() => initLeftBoxCarousel());
            initLeftBoxCarousel();
            adjustMenuOverflow();
        });
</script>